
### Walk through full run of WMDA analysis
## Imputation

### Pre-requisites
Make sure you've generated the graph db. See [Graph Generation](../graph_generator)

* Make sure the virtual environment is active.
	```
	cd graph-imputation-match
	source venv/bin/activate
	```

* Prepare data
   The `don.gl.txt.gz` file is generated by `g2gl` method. See [WMDA g2gl](../validation/wmda/)
	```
	cd validation/wmda/data
	gunzip -c don.gl.txt.gz > don.gl.txt
	gunzip -c pat.gl.txt.gz > pat.gl.txt
	```

   If you need to  reproduce consensus results for WMDA MVT 3 exactly, the donor D004016 needs to be updated with `33:03` typings. Apply the change:
	```
	git apply don.gl.txt_mvt-3-discrepancy.diff
	```

* Install `gl-impute` module.
	```
	cd ../../..
	cd gl_impute
	make install
	```

* Update `neo4j.json` file with the username/password for your Neo4J instance if different.
	```
	cd ../multi_race_impute
	edit neo4j.json
	```
* Start the imputation generation process. This process currently takes 2+ hours.
	```
	time python RunFile.py
	```
	....
	wait
	....

	```
		175.96s user 6.40s system 2% cpu 2:25:50.00 total
	```
* Finally.. The imputation results are produced in `output` directory.
	```
	output
	├── don.gl.txt_miss
	├── don.gl.txt_out
	├── don.gl.txt_val
	├── pat.gl.txt_miss
	├── pat.gl.txt_out
	└── pat.gl.txt_val
	```
